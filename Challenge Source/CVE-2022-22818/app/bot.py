from playwright.sync_api import sync_playwright

import logging
from secret import FLAG

logging.basicConfig(level=logging.INFO, format="%(asctime)s - %(message)s")

def check(name):
    logging.info(f"Name received in bot check: {name}")
    with sync_playwright() as p:
        browser = p.chromium.launch(headless=True)
        context = browser.new_context(ignore_https_errors=True)
        context.add_cookies([{
            "name": "flag",
            "value": FLAG,
            "domain": "localhost",
            "path": "/",
        }])
        page = context.new_page()
        page.goto("https://localhost:8000?name=" + name)
        page.wait_for_load_state("networkidle")
        browser.close()
